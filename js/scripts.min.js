"use strict";!function(){var e=document.getElementById("todo-input-field"),t=document.getElementById("todo-input-submit"),n=document.getElementById("todo-input-icon"),o=document.getElementById("todo-list"),i=document.getElementById("todo-list-complete"),s=document.getElementById("todo-summary"),a=document.getElementById("todo-summary-toggle"),d={incomplete:{},complete:{}};Sortable.create(o,{animation:150,onEnd:function(){g()}});var l=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=document.createElement("li");a.setAttribute("class","todo-item"),a.dataset.createdOn=t,a.dataset.completedOn=s,a.innerHTML='\n            <div class="todo-item-wrap">\n                <div class="todo-item-complete"><span><i class="fa fa-check" aria-hidden="true"></i></span></div>\n                <div class="todo-item-content">'+e+'</div>\n                <div class="todo-item-content-edit"><input type="text" class="todo-item-edit-field"></div>\n                <div class="todo-item-edit-options">\n                    <div class="todo-item-edit-confirm"><span><i class="fa fa-check" aria-hidden="true"></i></span></div>\n                    <div class="todo-item-edit-cancel"><span><i class="fa fa-times" aria-hidden="true"></i></span></div>\n                </div>\n                <div class="todo-item-options">\n                    <div class="todo-item-edit"><span><i class="fa fa-pencil" aria-hidden="true"></i></span></div>\n                    <div class="todo-item-delete"><span><i class="fa fa-trash-o" aria-hidden="true"></i></span></div>\n                </div>\n            </div>\n            <div class="todo-item-completed"><span>Completed!</span></div>\n            <div class="todo-item-deleted"><span>Deleted!</span></div>\n        ',m(a.getElementsByClassName("todo-item-complete")[0]),r(a.getElementsByClassName("todo-item-edit")[0]),c(a.getElementsByClassName("todo-item-edit-field")[0]),v(a.getElementsByClassName("todo-item-edit-confirm")[0]),p(a.getElementsByClassName("todo-item-edit-cancel")[0]),u(a.getElementsByClassName("todo-item-delete")[0]),f(),s?(i.append(a),a.classList.add("completed"),a.setAttribute("id","todocomplete-"+n),d.complete[n]={todo:e,created:t,completed:s}):(o.append(a),a.setAttribute("id","todo-"+n),d.incomplete[n]={todo:e,created:t,completed:s}),E()},m=function(e){var t=e.parentNode.parentNode,n=e.parentNode,o=t.getElementsByClassName("todo-item-completed")[0],i="false"!==t.dataset.completedOn;e.addEventListener("click",function(){i?(t.remove(),l(t.getElementsByClassName("todo-item-content")[0].innerHTML,t.dataset.createdOn,t.id.split("-")[1]),g()):(o.height=t.height,o.classList.add("active"),n.classList.add("slide"),setTimeout(function(){t.remove(),l(t.getElementsByClassName("todo-item-content")[0].innerHTML,t.dataset.createdOn,t.id.split("-")[1],moment().format("YYYY-MM-DD")),g()},750))})},c=function(e){var t=e.parentNode.parentNode;e.addEventListener("keyup",function(n){if(13===n.keyCode){if(""===e.value)return;t.getElementsByClassName("todo-item-content")[0].innerHTML=e.value,t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.classList.remove("active"),g()}})},r=function(e){var t=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-content")[0].classList.add("inactive"),t.getElementsByClassName("todo-item-edit-field")[0].value=t.getElementsByClassName("todo-item-content")[0].innerHTML,t.getElementsByClassName("todo-item-content-edit")[0].classList.add("active"),t.getElementsByClassName("todo-item-edit-field")[0].select(),t.classList.add("active")})},v=function(e){var t=e.parentNode.parentNode,n=t.getElementsByClassName("todo-item-edit-field")[0];e.addEventListener("click",function(){""!==n.value&&(t.getElementsByClassName("todo-item-content")[0].innerHTML=n.value,t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.classList.remove("active"),g())})},p=function(e){var t=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.getElementsByClassName("todo-item-edit")[0].getElementsByTagName("span")[0].classList.remove("active"),t.classList.remove("active")})},u=function(e){var t=e.parentNode.parentNode.parentNode,n=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-deleted")[0].height=t.clientHeight,t.getElementsByClassName("todo-item-deleted")[0].classList.add("active"),n.classList.add("slide"),setTimeout(function(){t.remove(),g()},750)})},f=function(){e.value=""},g=function(){var e=o.getElementsByClassName("todo-item"),t=i.getElementsByClassName("todo-item");if(d={incomplete:{},complete:{}},e.length>0)for(var n=0;n<e.length;n++)e[n].id="todo-"+(n+1),d.incomplete[n+1]={todo:e[n].getElementsByClassName("todo-item-content")[0].innerHTML,created:e[n].dataset.createdOn,completed:e[n].dataset.completedOn};if(t.length>0)for(var s=0;s<t.length;s++)t[s].id="todocomplete-"+(s+1),d.complete[s+1]={todo:t[s].getElementsByClassName("todo-item-content")[0].innerHTML,created:t[s].dataset.createdOn,completed:t[s].dataset.completedOn};E()},E=function(){chrome.storage.sync.remove("list",function(){chrome.storage.sync.set({list:d},function(){console.log("List updated.")})})},y=function(){chrome.storage.sync.get("list",function(e){for(var t in e.list.incomplete)if(e.list.incomplete.hasOwnProperty(t)){var n=e.list.incomplete[t];l(n.todo,n.created,t)}for(var o in e.list.complete)if(e.list.complete.hasOwnProperty(o)){var i=e.list.complete[o];l(i.todo,i.created,o,i.completed)}})},N=function(){y(),e.addEventListener("keyup",function(t){if(13===t.keyCode){if(""===e.value)return;l(e.value,moment().format("YYYY-MM-DD"),document.getElementsByClassName("todo-item").length+1)}}),t.addEventListener("click",function(){""!==e.value&&l(e.value,moment().format("YYYY-MM-DD"),document.getElementsByClassName("todo-item").length+1)}),a.addEventListener("click",function(){s.classList.contains("active")?s.classList.remove("active"):s.classList.add("active")}),n.addEventListener("click",function(){e.select()})};document.addEventListener("DOMContentLoaded",N)}();